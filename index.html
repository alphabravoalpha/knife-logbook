<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2299.77">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 13.0px 'Helvetica Neue'; -webkit-text-stroke: #000000}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 13.0px 'Helvetica Neue'; -webkit-text-stroke: #000000; min-height: 15.0px}
    span.s1 {font-kerning: none}
  </style>
</head>
<body>
<p class="p1"><span class="s1">&lt;!DOCTYPE html&gt;</span></p>
<p class="p1"><span class="s1">&lt;html lang="en"&gt;</span></p>
<p class="p1"><span class="s1">&lt;head&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;meta charset="UTF-8"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;title&gt;Knife Logbook&lt;/title&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;!-- Google API Client --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;script src="https://apis.google.com/js/api.js"&gt;&lt;/script&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;script src="https://accounts.google.com/gsi/client"&gt;&lt;/script&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;!-- Tailwind CSS via CDN --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;link href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;style&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.photo-preview {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>width: 100px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>height: 100px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>object-fit: cover;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>margin: 5px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>#photoPreviewContainer {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>display: flex;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>flex-wrap: wrap;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>@media (max-width: 640px) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>.form-container {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>padding: 0.5rem;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>input, select, textarea {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>font-size: 16px; /* Prevents iOS zoom on focus */</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;/style&gt;</span></p>
<p class="p1"><span class="s1">&lt;/head&gt;</span></p>
<p class="p1"><span class="s1">&lt;body class="bg-gray-100"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;div class="container mx-auto p-4"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;h1 class="text-3xl font-bold text-center mb-6"&gt;Knife Logbook&lt;/h1&gt;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;!-- Login Section --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;div id="loginSection" class="bg-white rounded-lg shadow p-6 mb-6"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;h2 class="text-xl font-semibold mb-4"&gt;Google Account Authentication&lt;/h2&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;p class="mb-4"&gt;Please sign in with your Google account to enable Google Sheets and Drive integration.&lt;/p&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;button id="authorizeButton" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>Sign In with Google</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;div id="loginStatus" class="mt-2"&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;!-- Main Form --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;div id="mainForm" class="bg-white rounded-lg shadow p-6 form-container" style="display: none;"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;div class="grid grid-cols-1 md:grid-cols-2 gap-6"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;!-- Left Column --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;div class="mb-4"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;label for="serialNumber" class="block text-gray-700 font-bold mb-2"&gt;Serial Number&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;input type="text" id="serialNumber" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" value="001"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                    </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;div class="mb-4"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;label for="dateCreated" class="block text-gray-700 font-bold mb-2"&gt;Date&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;input type="date" id="dateCreated" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                    </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;div class="mb-4"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;label for="knifeStyle" class="block text-gray-700 font-bold mb-2"&gt;Knife Style&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;select id="knifeStyle" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;option value=""&gt;Select Style&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;option value="Chef"&gt;Chef&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;option value="Santoku"&gt;Santoku&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;option value="Paring"&gt;Paring&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;option value="Boning"&gt;Boning&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;option value="Fillet"&gt;Fillet&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;option value="Hunting"&gt;Hunting&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;option value="Bushcraft"&gt;Bushcraft&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;option value="Utility"&gt;Utility&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;option value="Cleaver"&gt;Cleaver&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;option value="Gyuto"&gt;Gyuto&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;option value="Petty"&gt;Petty&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;option value="Bread"&gt;Bread&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;option value="Oyster"&gt;Oyster&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/select&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;div class="mt-2"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;input type="text" id="newKnifeStyle" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" placeholder="Add new style..."&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;button id="addKnifeStyle" class="mt-1 bg-gray-300 hover:bg-gray-400 text-black font-bold py-1 px-2 rounded text-sm"&gt;Add Style&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                    </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;div class="mb-4"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;label for="steelType" class="block text-gray-700 font-bold mb-2"&gt;Steel Type&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;select id="steelType" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;option value=""&gt;Select Steel&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;option value="1095"&gt;1095&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;option value="O1"&gt;O1&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;option value="W2"&gt;W2&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;option value="Damascus"&gt;Damascus&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;option value="80CrV2"&gt;80CrV2&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;option value="15N20"&gt;15N20&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;option value="52100"&gt;52100&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;option value="AEB-L"&gt;AEB-L&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;option value="154CM"&gt;154CM&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;option value="White Paper San Mai"&gt;White Paper San Mai&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/select&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;div class="mt-2"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;input type="text" id="newSteelType" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" placeholder="Add new steel type..."&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;button id="addSteelType" class="mt-1 bg-gray-300 hover:bg-gray-400 text-black font-bold py-1 px-2 rounded text-sm"&gt;Add Steel&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                    </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;div class="mb-4"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;label for="handleMaterial" class="block text-gray-700 font-bold mb-2"&gt;Handle Material&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;select id="handleMaterial" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;option value=""&gt;Select Material&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;option value="Walnut"&gt;Walnut&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;option value="Maple"&gt;Maple&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;option value="Oak"&gt;Oak&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;option value="Stabilized Wood"&gt;Stabilized Wood&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;option value="Micarta"&gt;Micarta&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;option value="G10"&gt;G10&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;option value="Carbon Fiber"&gt;Carbon Fiber&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;option value="Bone"&gt;Bone&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;option value="Antler"&gt;Antler&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;option value="Richlite"&gt;Richlite&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;option value="Cherry"&gt;Cherry&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;option value="Spalted Maple"&gt;Spalted Maple&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;option value="Claro Walnut Burl"&gt;Claro Walnut Burl&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;option value="Water Buffalo Horn"&gt;Water Buffalo Horn&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/select&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;div class="mt-2"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;input type="text" id="newHandleMaterial" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" placeholder="Add new material..."&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;button id="addHandleMaterial" class="mt-1 bg-gray-300 hover:bg-gray-400 text-black font-bold py-1 px-2 rounded text-sm"&gt;Add Material&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;!-- Right Column --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;div class="mb-4"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;label for="bladeLength" class="block text-gray-700 font-bold mb-2"&gt;Blade Length (inches)&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;input type="number" id="bladeLength" step="0.25" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                    </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;div class="mb-4"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;label for="overallLength" class="block text-gray-700 font-bold mb-2"&gt;Overall Length (inches)&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;input type="number" id="overallLength" step="0.25" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                    </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;div class="mb-4"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;label for="price" class="block text-gray-700 font-bold mb-2"&gt;Price (£)&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;input type="number" id="price" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                    </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;div class="mb-4"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;label for="photos" class="block text-gray-700 font-bold mb-2"&gt;Photos (Up to 10)&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;input type="file" id="photos" multiple accept="image/*" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;div id="photoPreviewContainer" class="mt-2"&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                    </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;div class="mb-4"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;label for="notes" class="block text-gray-700 font-bold mb-2"&gt;Notes/Comments&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;textarea id="notes" rows="3" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"&gt;&lt;/textarea&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;!-- AI Description Generation --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;div class="mt-6"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;label for="description" class="block text-gray-700 font-bold mb-2"&gt;Generated Description&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;button id="generateDescription" class="mb-2 bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>Generate Description</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;textarea id="description" rows="6" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"&gt;&lt;/textarea&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;!-- Submit Button --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;div class="mt-6 flex justify-center"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;button id="saveKnife" class="bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>Save Knife to Logbook</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;div id="saveStatus" class="mt-4 text-center"&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;!-- Previously Logged Knives --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;div id="previousEntries" class="mt-6 bg-white rounded-lg shadow p-6" style="display: none;"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;h2 class="text-xl font-semibold mb-4"&gt;Previous Entries&lt;/h2&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;div id="entriesList" class="overflow-x-auto"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;table class="min-w-full bg-white"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;thead&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;tr&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;th class="py-2 px-4 border-b text-left"&gt;Serial&lt;/th&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;th class="py-2 px-4 border-b text-left"&gt;Date&lt;/th&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;th class="py-2 px-4 border-b text-left"&gt;Style&lt;/th&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;th class="py-2 px-4 border-b text-left"&gt;Steel&lt;/th&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;th class="py-2 px-4 border-b text-left"&gt;Handle&lt;/th&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;th class="py-2 px-4 border-b text-left"&gt;Price (£)&lt;/th&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;th class="py-2 px-4 border-b text-left"&gt;Actions&lt;/th&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/tr&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/thead&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;tbody id="entriesTableBody"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;!-- Entries will be populated here --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/tbody&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;/table&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;script&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span>// Google API Configuration</span></p>
<p class="p1"><span class="s1">let CLIENT_ID = '';</span></p>
<p class="p1"><span class="s1">let API_KEY = '';</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Prompt user for credentials if not set</span></p>
<p class="p1"><span class="s1">if (!CLIENT_ID || !API_KEY) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// Check if credentials are stored in localStorage</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>const savedClientId = localStorage.getItem('knife_logbook_client_id');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>const savedApiKey = localStorage.getItem('knife_logbook_api_key');</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">  </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>if (savedClientId &amp;&amp; savedApiKey) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>CLIENT_ID = savedClientId;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>API_KEY = savedApiKey;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>CLIENT_ID = prompt("Please enter your Google Client ID:");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>API_KEY = prompt("Please enter your Google API Key:");</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">    </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// Save for future use if user agrees</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (confirm("Save these credentials for future use?")) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>localStorage.setItem('knife_logbook_client_id', CLIENT_ID);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>localStorage.setItem('knife_logbook_api_key', API_KEY);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const API_KEY = 'AIzaSyCaMdnazaqfztzNHUOv8LcrdmVF2E5_65U';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const DISCOVERY_DOCS = [</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>'https://sheets.googleapis.com/$discovery/rest?version=v4',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>'https://www.googleapis.com/discovery/v1/apis/drive/v3/rest'</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const SCOPES = 'https://www.googleapis.com/auth/spreadsheets https://www.googleapis.com/auth/drive';</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>let tokenClient;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>let gapiInited = false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>let gisInited = false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>let spreadsheetId = '';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>let folderId = '';</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Helper function to get today's date in YYYY-MM-DD format</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>function getTodayDate() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const today = new Date();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const year = today.getFullYear();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const month = String(today.getMonth() + 1).padStart(2, '0');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const day = String(today.getDate()).padStart(2, '0');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>return `${year}-${month}-${day}`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Set today's date as default</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>document.addEventListener('DOMContentLoaded', function() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>document.getElementById('dateCreated').value = getTodayDate();</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// Initialize the page</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>initializeGoogleAPIs();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>});</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Initialize the Google APIs</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>function initializeGoogleAPIs() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// Initialize the gapi client</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>gapi.load('client', initGapiClient);</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// Initialize the token client</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>tokenClient = google.accounts.oauth2.initTokenClient({</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>client_id: CLIENT_ID,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>scope: SCOPES,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>callback: handleAuthResponse</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>gisInited = true;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// Set up the authorize button</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>document.getElementById('authorizeButton').addEventListener('click', handleAuthClick);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>async function initGapiClient() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>await gapi.client.init({</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>apiKey: API_KEY,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>discoveryDocs: DISCOVERY_DOCS,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>gapiInited = true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>function handleAuthClick() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (!gapiInited || !gisInited) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>document.getElementById('loginStatus').textContent = 'API client not initialized';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>tokenClient.requestAccessToken();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>async function handleAuthResponse(tokenResponse) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (tokenResponse &amp;&amp; !tokenResponse.error) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>document.getElementById('loginStatus').textContent = 'Authentication successful!';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>document.getElementById('loginSection').style.display = 'none';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>document.getElementById('mainForm').style.display = 'block';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>document.getElementById('previousEntries').style.display = 'block';</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// Check if spreadsheet and folder exist, if not create them</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>await setupGoogleResources();</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// Load previous entries</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>loadPreviousEntries();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>document.getElementById('loginStatus').textContent = 'Authentication failed: ' + (tokenResponse ? tokenResponse.error : 'No response');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Set up Google Sheets and Drive resources</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>async function setupGoogleResources() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// Check if "Knife Logbook" spreadsheet exists</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const sheetsResponse = await gapi.client.sheets.spreadsheets.list({</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>q: "name='Knife Logbook'"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>});</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (sheetsResponse.result.files &amp;&amp; sheetsResponse.result.files.length &gt; 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>spreadsheetId = sheetsResponse.result.files[0].id;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>// Create a new spreadsheet</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>const createResponse = await gapi.client.sheets.spreadsheets.create({</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>properties: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>title: 'Knife Logbook'</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>sheets: [</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>{</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>properties: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span>title: 'Knives',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span>gridProperties: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span>frozenRowCount: 1</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>]</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>});</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                    </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>spreadsheetId = createResponse.result.spreadsheetId;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                    </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>// Set up the header row</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>await gapi.client.sheets.spreadsheets.values.update({</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>spreadsheetId: spreadsheetId,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>range: 'Knives!A1:M1',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>valueInputOption: 'RAW',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>resource: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>values: [['Serial Number', 'Date', 'Knife Style', 'Steel Type', 'Handle Material', 'Blade Length', 'Overall Length', 'Price', 'Notes', 'Description', 'Photos Folder', 'Photo Links', 'Timestamp']]</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>});</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                    </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>// Format header row</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>await gapi.client.sheets.spreadsheets.batchUpdate({</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>spreadsheetId: spreadsheetId,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>resource: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>requests: [</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>{</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span>repeatCell: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span>range: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                            </span>sheetId: 0,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                            </span>startRowIndex: 0,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                            </span>endRowIndex: 1</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span>cell: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                            </span>userEnteredFormat: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                                </span>textFormat: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                                    </span>bold: true</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                                </span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                                </span>backgroundColor: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                                    </span>red: 0.8,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                                    </span>green: 0.8,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                                    </span>blue: 0.8</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span>fields: 'userEnteredFormat(textFormat,backgroundColor)'</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>]</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// Check if "Knife Photos" folder exists in Google Drive</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const driveResponse = await gapi.client.drive.files.list({</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>q: "name='Knife Photos' and mimeType='application/vnd.google-apps.folder'",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>fields: 'files(id, name)'</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>});</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (driveResponse.result.files &amp;&amp; driveResponse.result.files.length &gt; 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>folderId = driveResponse.result.files[0].id;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>// Create a new folder</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>const folderResponse = await gapi.client.drive.files.create({</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>resource: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>name: 'Knife Photos',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>mimeType: 'application/vnd.google-apps.folder'</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>fields: 'id'</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>});</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                    </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>folderId = folderResponse.result.id;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>document.getElementById('saveStatus').textContent = 'Google resources set up successfully!';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>setTimeout(() =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>document.getElementById('saveStatus').textContent = '';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}, 3000);</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>} catch (error) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>console.error('Error setting up Google resources:', error);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>document.getElementById('saveStatus').textContent = 'Error setting up Google resources: ' + error.message;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Load previous entries from the spreadsheet</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>async function loadPreviousEntries() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const response = await gapi.client.sheets.spreadsheets.values.get({</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>spreadsheetId: spreadsheetId,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>range: 'Knives!A2:G'</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>});</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const rows = response.result.values || [];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const tableBody = document.getElementById('entriesTableBody');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>tableBody.innerHTML = '';</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>rows.forEach((row, index) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>if (row.length &gt;= 7) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>const tr = document.createElement('tr');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>tr.innerHTML = `</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;td class="py-2 px-4 border-b"&gt;${row[0]}&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;td class="py-2 px-4 border-b"&gt;${row[1]}&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;td class="py-2 px-4 border-b"&gt;${row[2]}&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;td class="py-2 px-4 border-b"&gt;${row[3]}&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;td class="py-2 px-4 border-b"&gt;${row[4]}&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;td class="py-2 px-4 border-b"&gt;£${row[7]}&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;td class="py-2 px-4 border-b"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;button class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-1 px-2 rounded mr-1 view-btn" data-row="${index+2}"&gt;View&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>tableBody.appendChild(tr);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>});</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// Add event listeners to view buttons</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>document.querySelectorAll('.view-btn').forEach(button =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>button.addEventListener('click', function() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>const rowIndex = this.getAttribute('data-row');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>viewKnifeDetails(rowIndex);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>});</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>} catch (error) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>console.error('Error loading previous entries:', error);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// View knife details</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>async function viewKnifeDetails(rowIndex) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const response = await gapi.client.sheets.spreadsheets.values.get({</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>spreadsheetId: spreadsheetId,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>range: `Knives!A${rowIndex}:L${rowIndex}`</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>});</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const row = response.result.values[0];</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// Populate the form with the knife details</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>document.getElementById('serialNumber').value = row[0];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>document.getElementById('dateCreated').value = row[1];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>document.getElementById('knifeStyle').value = row[2];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>document.getElementById('steelType').value = row[3];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>document.getElementById('handleMaterial').value = row[4];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>document.getElementById('bladeLength').value = row[5];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>document.getElementById('overallLength').value = row[6];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>document.getElementById('price').value = row[7];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>document.getElementById('notes').value = row[8];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>document.getElementById('description').value = row[9];</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// Clear photo previews</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>document.getElementById('photoPreviewContainer').innerHTML = '';</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// If there are photo links, try to show them</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (row[11]) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>const photoLinks = row[11].split(',');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>photoLinks.forEach(photoLink =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>if (photoLink.trim()) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>const img = document.createElement('img');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>img.src = photoLink.trim();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>img.className = 'photo-preview';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>document.getElementById('photoPreviewContainer').appendChild(img);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>document.getElementById('saveStatus').textContent = 'Knife details loaded. You can make changes and save again.';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>setTimeout(() =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>document.getElementById('saveStatus').textContent = '';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}, 3000);</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>} catch (error) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>console.error('Error viewing knife details:', error);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>document.getElementById('saveStatus').textContent = 'Error viewing knife details: ' + error.message;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Photo preview functionality</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>document.getElementById('photos').addEventListener('change', function(event) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const files = event.target.files;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const container = document.getElementById('photoPreviewContainer');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>container.innerHTML = '';</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (files.length &gt; 10) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>alert('You can only upload up to 10 photos.');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>this.value = '';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>for (let i = 0; i &lt; files.length; i++) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const file = files[i];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (file.type.startsWith('image/')) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>const reader = new FileReader();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>reader.onload = function(e) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>const img = document.createElement('img');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>img.src = e.target.result;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>img.className = 'photo-preview';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>container.appendChild(img);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>reader.readAsDataURL(file);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>});</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Add new knife style</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>document.getElementById('addKnifeStyle').addEventListener('click', function() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const newStyle = document.getElementById('newKnifeStyle').value.trim();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (newStyle) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const select = document.getElementById('knifeStyle');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const option = document.createElement('option');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>option.value = newStyle;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>option.textContent = newStyle;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>select.appendChild(option);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>select.value = newStyle;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>document.getElementById('newKnifeStyle').value = '';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>});</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Add new steel type</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>document.getElementById('addSteelType').addEventListener('click', function() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const newSteel = document.getElementById('newSteelType').value.trim();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (newSteel) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const select = document.getElementById('steelType');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const option = document.createElement('option');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>option.value = newSteel;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>option.textContent = newSteel;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>select.appendChild(option);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>select.value = newSteel;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>document.getElementById('newSteelType').value = '';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>});</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Add new handle material</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>document.getElementById('addHandleMaterial').addEventListener('click', function() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const newMaterial = document.getElementById('newHandleMaterial').value.trim();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (newMaterial) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const select = document.getElementById('handleMaterial');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const option = document.createElement('option');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>option.value = newMaterial;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>option.textContent = newMaterial;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>select.appendChild(option);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>select.value = newMaterial;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>document.getElementById('newHandleMaterial').value = '';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>});</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Generate AI description</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>document.getElementById('generateDescription').addEventListener('click', function() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>generateKnifeDescription();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>});</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Function to generate knife description based on input fields</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>function generateKnifeDescription() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const bladeLength = document.getElementById('bladeLength').value;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const knifeStyle = document.getElementById('knifeStyle').value;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const steelType = document.getElementById('steelType').value;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const handleMaterial = document.getElementById('handleMaterial').value;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (!bladeLength || !knifeStyle || !steelType || !handleMaterial) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>alert('Please fill in blade length, knife style, steel type, and handle material before generating a description.');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>let steelDescription = '';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (steelType.includes('AEB-L')) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>steelDescription = 'known in the industry for its fine grain structure and ability to obtain a razor like edge';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>} else if (steelType.includes('80CrV2')) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>steelDescription = 'renowned for its toughness, hardness, and razor edge';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>} else if (steelType.includes('White Paper San Mai')) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>steelDescription = 'an exceptionally pure and fine grained steel';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>steelDescription = 'a high-quality steel known for its excellent edge retention and durability';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>let knifeDescription = '';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (knifeStyle === 'Chef' || knifeStyle === 'Gyuto') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>knifeDescription = 'This knife is a true all rounder in the kitchen. ' +<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>(knifeStyle === 'Gyuto' ?<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>'This Japanese influenced profile features a long cutting edge, with a deep heel and distal taper towards the tip.' :<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>'The European profile features a deep heel and great knuckle clearance, for robust chopping, and a fine tip for slicing and more delicate work.');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>} else if (knifeStyle === 'Santoku') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>knifeDescription = 'The deep blade and short profile of this blade is designed to chop. The slight curve of the edge and flat heal mean you\'ll be able to rock chop (till you drop...) without leaving those little bits of vegetables uncut at the very end of the slice.';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>} else if (knifeStyle === 'Paring') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>knifeDescription = 'The paring knife is perfect for any small or delicate kitchen tasks such as cutting herbs and garlic, peeling, mincing, and generally any task that requires a light and nimble knife.';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>} else if (knifeStyle === 'Petty') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>knifeDescription = 'A personal favorite, the petty combines the nimbleness of the paring with the full bodied blade of a chefs knife and is extremely versatile. It will perform extremely well as either a smaller knife, or a larger knife.';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>} else if (knifeStyle === 'Bread') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>knifeDescription = 'Perfect for cutting any bread, be it a crusty sourdough or soft brioche, this serrated bread knife has the length and knuckle clearance for comfortable bread cutting.';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>} else if (knifeStyle === 'Cleaver') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>knifeDescription = 'This rectangular profile features a deep, flat edge, and great knuckle clearance for maximum chopping efficiency.';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>} else if (knifeStyle === 'Oyster') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>knifeDescription = 'The tip is fine enough to get into the hinge of an oyster, while also being robust enough to withstand the strong forces of opening an oyster.';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>knifeDescription = 'This knife has an excellent balance of form and function, designed for precision cutting tasks with comfort and control.';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>let handleDescription = '';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (handleMaterial.includes('Tang')) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>handleDescription = `The ${handleMaterial.includes('hidden') ? 'hidden' : 'full'} tang handle`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>handleDescription = `The handle is ${handleMaterial}`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>let balanceDescription = '';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (knifeStyle === 'Chef' || knifeStyle === 'Gyuto' || knifeStyle === 'Santoku') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>balanceDescription = 'The knife is balanced right where the blade meets the handle, making for a light and even feel to the knife.';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>} else if (handleMaterial.includes('full tang')) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>balanceDescription = 'The full tang handle adds heft for people who prefer to feel a heavier knife in hand, while still extremely well balanced and extremely comfortable to use.';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const description = `This ${bladeLength}" ${steelType.includes('High') ? 'High Carbon' : 'Stainless'} ${knifeStyle} knife is made from ${steelType} ${steelDescription}. ${handleDescription}, with black and white G10 liners and stainless Corby Bolts. ${knifeDescription} ${balanceDescription}`;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>document.getElementById('description').value = description;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Save knife to logbook</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>document.getElementById('saveKnife').addEventListener('click', async function() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>saveKnifeToLogbook();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>});</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Function to save knife data to Google Sheets and Drive</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>async function saveKnifeToLogbook() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const serialNumber = document.getElementById('serialNumber').value.trim();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const dateCreated = document.getElementById('dateCreated').value;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const knifeStyle = document.getElementById('knifeStyle').value;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const steelType = document.getElementById('steelType').value;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const handleMaterial = document.getElementById('handleMaterial').value;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const bladeLength = document.getElementById('bladeLength').value;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const overallLength = document.getElementById('overallLength').value;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const price = document.getElementById('price').value;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const notes = document.getElementById('notes').value;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const description = document.getElementById('description').value;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const photos = document.getElementById('photos').files;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// Basic validation</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (!serialNumber || !dateCreated || !knifeStyle || !steelType || !handleMaterial || !bladeLength || !price) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>alert('Please fill in all required fields (Serial Number, Date, Knife Style, Steel Type, Handle Material, Blade Length, and Price).');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>document.getElementById('saveStatus').textContent = 'Saving knife data...';</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// Create a subfolder for this knife</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const knifeFolderName = `${serialNumber}_${knifeStyle}_${handleMaterial}`.replace(/[^\w\s]/gi, '_');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const knifeFolder = await gapi.client.drive.files.create({</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>resource: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>name: knifeFolderName,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>mimeType: 'application/vnd.google-apps.folder',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>parents: [folderId]</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>fields: 'id, webViewLink'</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>});</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const knifeFolderId = knifeFolder.result.id;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const knifeFolderLink = knifeFolder.result.webViewLink;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// Upload photos</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const photoLinks = [];</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (photos.length &gt; 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>for (let i = 0; i &lt; photos.length; i++) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>const photo = photos[i];</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                        </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>// Create a form data object to upload the file</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>const form = new FormData();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>form.append('metadata', new Blob([JSON.stringify({</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>name: `${serialNumber}_${i+1}_${photo.name}`,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>parents: [knifeFolderId]</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>})], { type: 'application/json' }));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>form.append('file', photo);</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                        </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>// Upload the file to Google Drive</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>const accessToken = gapi.auth.getToken().access_token;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>const uploadResponse = await fetch('https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart', {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>method: 'POST',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>headers: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>Authorization: `Bearer ${accessToken}`</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>body: form</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>});</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                        </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>const uploadResult = await uploadResponse.json();</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                        </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>// Make the file publicly viewable</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>await gapi.client.drive.permissions.create({</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>fileId: uploadResult.id,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>resource: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>role: 'reader',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>type: 'anyone'</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>});</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                        </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>// Get the webContentLink</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>const fileResponse = await gapi.client.drive.files.get({</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>fileId: uploadResult.id,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>fields: 'webContentLink'</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>});</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                        </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>photoLinks.push(fileResponse.result.webContentLink);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// Prepare data for the spreadsheet</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const timestamp = new Date().toISOString();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const rowData = [</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>serialNumber,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>dateCreated,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>knifeStyle,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>steelType,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>handleMaterial,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>bladeLength,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>overallLength,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>price,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>notes,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>description,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>knifeFolderLink,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>photoLinks.join(','),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>timestamp</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>];</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// Find if this serial number already exists</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const existingResponse = await gapi.client.sheets.spreadsheets.values.get({</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>spreadsheetId: spreadsheetId,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>range: 'Knives!A:A'</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>});</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const serialNumbers = existingResponse.result.values || [];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>let existingRow = -1;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>for (let i = 1; i &lt; serialNumbers.length; i++) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>if (serialNumbers[i] &amp;&amp; serialNumbers[i][0] === serialNumber) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>existingRow = i + 1; // +1 because rows are 1-indexed in sheets API</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>break;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// Update or append data</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (existingRow &gt; 1) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>// Update existing row</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>await gapi.client.sheets.spreadsheets.values.update({</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>spreadsheetId: spreadsheetId,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>range: `Knives!A${existingRow}:M${existingRow}`,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>valueInputOption: 'RAW',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>resource: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>values: [rowData]</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>});</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                    </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>document.getElementById('saveStatus').textContent = `Knife data updated for serial number ${serialNumber}`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>// Append new row</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>await gapi.client.sheets.spreadsheets.values.append({</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>spreadsheetId: spreadsheetId,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>range: 'Knives!A:M',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>valueInputOption: 'RAW',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>insertDataOption: 'INSERT_ROWS',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>resource: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>values: [rowData]</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>});</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                    </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>document.getElementById('saveStatus').textContent = `New knife data saved with serial number ${serialNumber}`;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                    </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>// If this was a new entry, increment the serial number for the next knife</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>const nextSerial = (parseInt(serialNumber.replace(/\D/g, '')) + 1).toString().padStart(3, '0');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>document.getElementById('serialNumber').value = nextSerial;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// Reload previous entries</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>loadPreviousEntries();</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// Reset form except serial number and date</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>document.getElementById('knifeStyle').value = '';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>document.getElementById('steelType').value = '';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>document.getElementById('handleMaterial').value = '';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>document.getElementById('bladeLength').value = '';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>document.getElementById('overallLength').value = '';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>document.getElementById('price').value = '';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>document.getElementById('notes').value = '';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>document.getElementById('description').value = '';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>document.getElementById('photos').value = '';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>document.getElementById('photoPreviewContainer').innerHTML = '';</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>setTimeout(() =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>document.getElementById('saveStatus').textContent = '';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}, 5000);</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>} catch (error) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>console.error('Error saving knife data:', error);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>document.getElementById('saveStatus').textContent = 'Error saving knife data: ' + error.message;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;/script&gt;</span></p>
<p class="p1"><span class="s1">&lt;/body&gt;</span></p>
<p class="p1"><span class="s1">&lt;/html&gt;</span></p>
</body>
</html>
