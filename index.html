<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2299.77">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 13.0px 'Helvetica Neue'}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 13.0px 'Helvetica Neue'; min-height: 15.0px}
    p.p3 {margin: 0.0px 0.0px 0.0px 0.0px; font: 13.0px 'Helvetica Neue'; color: #dca10d}
    span.s1 {color: #000000}
  </style>
</head>
<body>
<p class="p1">&lt;!DOCTYPE html&gt;</p>
<p class="p1">&lt;html lang="en"&gt;</p>
<p class="p1">&lt;head&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;meta charset="UTF-8"&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;title&gt;Knife Logbook&lt;/title&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;!-- Google API Client --&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;script src="https://apis.google.com/js/api.js"&gt;&lt;/script&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;script src="https://accounts.google.com/gsi/client"&gt;&lt;/script&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;!-- Tailwind CSS via CDN --&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;link href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet"&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;style&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>.photo-preview {</p>
<p class="p1"><span class="Apple-converted-space">            </span>width: 100px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>height: 100px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>object-fit: cover;</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin: 5px;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>#photoPreviewContainer {</p>
<p class="p1"><span class="Apple-converted-space">            </span>display: flex;</p>
<p class="p1"><span class="Apple-converted-space">            </span>flex-wrap: wrap;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>@media (max-width: 640px) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>.form-container {</p>
<p class="p1"><span class="Apple-converted-space">                </span>padding: 0.5rem;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>input, select, textarea {</p>
<p class="p1"><span class="Apple-converted-space">                </span>font-size: 16px; /* Prevents iOS zoom on focus */</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/style&gt;</p>
<p class="p1">&lt;/head&gt;</p>
<p class="p1">&lt;body class="bg-gray-100"&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div class="container mx-auto p-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;h1 class="text-3xl font-bold text-center mb-6"&gt;Knife Logbook&lt;/h1&gt;</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;!-- Login Section --&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div id="loginSection" class="bg-white rounded-lg shadow p-6 mb-6"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;h2 class="text-xl font-semibold mb-4"&gt;Google Account Authentication&lt;/h2&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;p class="mb-4"&gt;Please sign in with your Google account to enable Google Sheets and Drive integration.&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;button id="authorizeButton" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>Sign In with Google</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div id="loginStatus" class="mt-2"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;!-- Main Form --&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div id="mainForm" class="bg-white rounded-lg shadow p-6 form-container" style="display: none;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div class="grid grid-cols-1 md:grid-cols-2 gap-6"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;!-- Left Column --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="mb-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;label for="serialNumber" class="block text-gray-700 font-bold mb-2"&gt;Serial Number&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;input type="text" id="serialNumber" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" value="001"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="mb-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;label for="dateCreated" class="block text-gray-700 font-bold mb-2"&gt;Date&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;input type="date" id="dateCreated" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="mb-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;label for="knifeStyle" class="block text-gray-700 font-bold mb-2"&gt;Knife Style&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;select id="knifeStyle" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;option value=""&gt;Select Style&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;option value="Chef"&gt;Chef&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;option value="Santoku"&gt;Santoku&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;option value="Paring"&gt;Paring&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;option value="Boning"&gt;Boning&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;option value="Fillet"&gt;Fillet&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;option value="Hunting"&gt;Hunting&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;option value="Bushcraft"&gt;Bushcraft&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;option value="Utility"&gt;Utility&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;option value="Cleaver"&gt;Cleaver&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;option value="Gyuto"&gt;Gyuto&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;option value="Petty"&gt;Petty&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;option value="Bread"&gt;Bread&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;option value="Oyster"&gt;Oyster&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/select&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div class="mt-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;input type="text" id="newKnifeStyle" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" placeholder="Add new style..."&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;button id="addKnifeStyle" class="mt-1 bg-gray-300 hover:bg-gray-400 text-black font-bold py-1 px-2 rounded text-sm"&gt;Add Style&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="mb-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;label for="steelType" class="block text-gray-700 font-bold mb-2"&gt;Steel Type&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;select id="steelType" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;option value=""&gt;Select Steel&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;option value="1095"&gt;1095&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;option value="O1"&gt;O1&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;option value="W2"&gt;W2&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;option value="Damascus"&gt;Damascus&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;option value="80CrV2"&gt;80CrV2&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;option value="15N20"&gt;15N20&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;option value="52100"&gt;52100&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;option value="AEB-L"&gt;AEB-L&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;option value="154CM"&gt;154CM&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;option value="White Paper San Mai"&gt;White Paper San Mai&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/select&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div class="mt-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;input type="text" id="newSteelType" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" placeholder="Add new steel type..."&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;button id="addSteelType" class="mt-1 bg-gray-300 hover:bg-gray-400 text-black font-bold py-1 px-2 rounded text-sm"&gt;Add Steel&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="mb-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;label for="handleMaterial" class="block text-gray-700 font-bold mb-2"&gt;Handle Material&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;select id="handleMaterial" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;option value=""&gt;Select Material&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;option value="Walnut"&gt;Walnut&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;option value="Maple"&gt;Maple&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;option value="Oak"&gt;Oak&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;option value="Stabilized Wood"&gt;Stabilized Wood&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;option value="Micarta"&gt;Micarta&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;option value="G10"&gt;G10&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;option value="Carbon Fiber"&gt;Carbon Fiber&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;option value="Bone"&gt;Bone&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;option value="Antler"&gt;Antler&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;option value="Richlite"&gt;Richlite&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;option value="Cherry"&gt;Cherry&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;option value="Spalted Maple"&gt;Spalted Maple&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;option value="Claro Walnut Burl"&gt;Claro Walnut Burl&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;option value="Water Buffalo Horn"&gt;Water Buffalo Horn&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/select&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div class="mt-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;input type="text" id="newHandleMaterial" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" placeholder="Add new material..."&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;button id="addHandleMaterial" class="mt-1 bg-gray-300 hover:bg-gray-400 text-black font-bold py-1 px-2 rounded text-sm"&gt;Add Material&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;!-- Right Column --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="mb-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;label for="bladeLength" class="block text-gray-700 font-bold mb-2"&gt;Blade Length (inches)&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;input type="number" id="bladeLength" step="0.25" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="mb-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;label for="overallLength" class="block text-gray-700 font-bold mb-2"&gt;Overall Length (inches)&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;input type="number" id="overallLength" step="0.25" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="mb-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;label for="price" class="block text-gray-700 font-bold mb-2"&gt;Price (£)&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;input type="number" id="price" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="mb-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;label for="photos" class="block text-gray-700 font-bold mb-2"&gt;Photos (Up to 10)&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;input type="file" id="photos" multiple accept="image/*" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div id="photoPreviewContainer" class="mt-2"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="mb-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;label for="notes" class="block text-gray-700 font-bold mb-2"&gt;Notes/Comments&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;textarea id="notes" rows="3" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"&gt;&lt;/textarea&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;!-- AI Description Generation --&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div class="mt-6"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;label for="description" class="block text-gray-700 font-bold mb-2"&gt;Generated Description&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;button id="generateDescription" class="mb-2 bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>Generate Description</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;textarea id="description" rows="6" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"&gt;&lt;/textarea&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;!-- Submit Button --&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div class="mt-6 flex justify-center"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;button id="saveKnife" class="bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>Save Knife to Logbook</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div id="saveStatus" class="mt-4 text-center"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;!-- Previously Logged Knives --&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div id="previousEntries" class="mt-6 bg-white rounded-lg shadow p-6" style="display: none;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;h2 class="text-xl font-semibold mb-4"&gt;Previous Entries&lt;/h2&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div id="entriesList" class="overflow-x-auto"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;table class="min-w-full bg-white"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;thead&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;tr&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;th class="py-2 px-4 border-b text-left"&gt;Serial&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;th class="py-2 px-4 border-b text-left"&gt;Date&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;th class="py-2 px-4 border-b text-left"&gt;Style&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;th class="py-2 px-4 border-b text-left"&gt;Steel&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;th class="py-2 px-4 border-b text-left"&gt;Handle&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;th class="py-2 px-4 border-b text-left"&gt;Price (£)&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;th class="py-2 px-4 border-b text-left"&gt;Actions&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/tr&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/thead&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;tbody id="entriesTableBody"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;!-- Entries will be populated here --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/tbody&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/table&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;script&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>// Google API Configuration</p>
<p class="p3"><span class="s1"><span class="Apple-converted-space">        </span>const CLIENT_ID = '<a href="http://200290486738-cdneu3osan7u83ddibqu2ur2ngafit2r.apps.googleusercontent.com">200290486738-cdneu3osan7u83ddibqu2ur2ngafit2r.apps.googleusercontent.com</a>';</span></p>
<p class="p1"><span class="Apple-converted-space">        </span>const API_KEY = 'AIzaSyCaMdnazaqfztzNHUOv8LcrdmVF2E5_65U';</p>
<p class="p1"><span class="Apple-converted-space">        </span>const DISCOVERY_DOCS = [</p>
<p class="p1"><span class="Apple-converted-space">            </span>'https://sheets.googleapis.com/$discovery/rest?version=v4',</p>
<p class="p1"><span class="Apple-converted-space">            </span>'https://www.googleapis.com/discovery/v1/apis/drive/v3/rest'</p>
<p class="p1"><span class="Apple-converted-space">        </span>];</p>
<p class="p1"><span class="Apple-converted-space">        </span>const SCOPES = 'https://www.googleapis.com/auth/spreadsheets https://www.googleapis.com/auth/drive';</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>let tokenClient;</p>
<p class="p1"><span class="Apple-converted-space">        </span>let gapiInited = false;</p>
<p class="p1"><span class="Apple-converted-space">        </span>let gisInited = false;</p>
<p class="p1"><span class="Apple-converted-space">        </span>let spreadsheetId = '';</p>
<p class="p1"><span class="Apple-converted-space">        </span>let folderId = '';</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Helper function to get today's date in YYYY-MM-DD format</p>
<p class="p1"><span class="Apple-converted-space">        </span>function getTodayDate() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const today = new Date();</p>
<p class="p1"><span class="Apple-converted-space">            </span>const year = today.getFullYear();</p>
<p class="p1"><span class="Apple-converted-space">            </span>const month = String(today.getMonth() + 1).padStart(2, '0');</p>
<p class="p1"><span class="Apple-converted-space">            </span>const day = String(today.getDate()).padStart(2, '0');</p>
<p class="p1"><span class="Apple-converted-space">            </span>return `${year}-${month}-${day}`;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Set today's date as default</p>
<p class="p1"><span class="Apple-converted-space">        </span>document.addEventListener('DOMContentLoaded', function() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('dateCreated').value = getTodayDate();</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Initialize the page</p>
<p class="p1"><span class="Apple-converted-space">            </span>initializeGoogleAPIs();</p>
<p class="p1"><span class="Apple-converted-space">        </span>});</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Initialize the Google APIs</p>
<p class="p1"><span class="Apple-converted-space">        </span>function initializeGoogleAPIs() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>// Initialize the gapi client</p>
<p class="p1"><span class="Apple-converted-space">            </span>gapi.load('client', initGapiClient);</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Initialize the token client</p>
<p class="p1"><span class="Apple-converted-space">            </span>tokenClient = google.accounts.oauth2.initTokenClient({</p>
<p class="p1"><span class="Apple-converted-space">                </span>client_id: CLIENT_ID,</p>
<p class="p1"><span class="Apple-converted-space">                </span>scope: SCOPES,</p>
<p class="p1"><span class="Apple-converted-space">                </span>callback: handleAuthResponse</p>
<p class="p1"><span class="Apple-converted-space">            </span>});</p>
<p class="p1"><span class="Apple-converted-space">            </span>gisInited = true;</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Set up the authorize button</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('authorizeButton').addEventListener('click', handleAuthClick);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>async function initGapiClient() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>await gapi.client.init({</p>
<p class="p1"><span class="Apple-converted-space">                </span>apiKey: API_KEY,</p>
<p class="p1"><span class="Apple-converted-space">                </span>discoveryDocs: DISCOVERY_DOCS,</p>
<p class="p1"><span class="Apple-converted-space">            </span>});</p>
<p class="p1"><span class="Apple-converted-space">            </span>gapiInited = true;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>function handleAuthClick() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (!gapiInited || !gisInited) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>document.getElementById('loginStatus').textContent = 'API client not initialized';</p>
<p class="p1"><span class="Apple-converted-space">                </span>return;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>tokenClient.requestAccessToken();</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>async function handleAuthResponse(tokenResponse) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (tokenResponse &amp;&amp; !tokenResponse.error) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>document.getElementById('loginStatus').textContent = 'Authentication successful!';</p>
<p class="p1"><span class="Apple-converted-space">                </span>document.getElementById('loginSection').style.display = 'none';</p>
<p class="p1"><span class="Apple-converted-space">                </span>document.getElementById('mainForm').style.display = 'block';</p>
<p class="p1"><span class="Apple-converted-space">                </span>document.getElementById('previousEntries').style.display = 'block';</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// Check if spreadsheet and folder exist, if not create them</p>
<p class="p1"><span class="Apple-converted-space">                </span>await setupGoogleResources();</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// Load previous entries</p>
<p class="p1"><span class="Apple-converted-space">                </span>loadPreviousEntries();</p>
<p class="p1"><span class="Apple-converted-space">            </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                </span>document.getElementById('loginStatus').textContent = 'Authentication failed: ' + (tokenResponse ? tokenResponse.error : 'No response');</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Set up Google Sheets and Drive resources</p>
<p class="p1"><span class="Apple-converted-space">        </span>async function setupGoogleResources() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>try {</p>
<p class="p1"><span class="Apple-converted-space">                </span>// Check if "Knife Logbook" spreadsheet exists</p>
<p class="p1"><span class="Apple-converted-space">                </span>const sheetsResponse = await gapi.client.sheets.spreadsheets.list({</p>
<p class="p1"><span class="Apple-converted-space">                    </span>q: "name='Knife Logbook'"</p>
<p class="p1"><span class="Apple-converted-space">                </span>});</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>if (sheetsResponse.result.files &amp;&amp; sheetsResponse.result.files.length &gt; 0) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>spreadsheetId = sheetsResponse.result.files[0].id;</p>
<p class="p1"><span class="Apple-converted-space">                </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>// Create a new spreadsheet</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const createResponse = await gapi.client.sheets.spreadsheets.create({</p>
<p class="p1"><span class="Apple-converted-space">                        </span>properties: {</p>
<p class="p1"><span class="Apple-converted-space">                            </span>title: 'Knife Logbook'</p>
<p class="p1"><span class="Apple-converted-space">                        </span>},</p>
<p class="p1"><span class="Apple-converted-space">                        </span>sheets: [</p>
<p class="p1"><span class="Apple-converted-space">                            </span>{</p>
<p class="p1"><span class="Apple-converted-space">                                </span>properties: {</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>title: 'Knives',</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>gridProperties: {</p>
<p class="p1"><span class="Apple-converted-space">                                        </span>frozenRowCount: 1</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>}</p>
<p class="p1"><span class="Apple-converted-space">                                </span>}</p>
<p class="p1"><span class="Apple-converted-space">                            </span>}</p>
<p class="p1"><span class="Apple-converted-space">                        </span>]</p>
<p class="p1"><span class="Apple-converted-space">                    </span>});</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>spreadsheetId = createResponse.result.spreadsheetId;</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>// Set up the header row</p>
<p class="p1"><span class="Apple-converted-space">                    </span>await gapi.client.sheets.spreadsheets.values.update({</p>
<p class="p1"><span class="Apple-converted-space">                        </span>spreadsheetId: spreadsheetId,</p>
<p class="p1"><span class="Apple-converted-space">                        </span>range: 'Knives!A1:M1',</p>
<p class="p1"><span class="Apple-converted-space">                        </span>valueInputOption: 'RAW',</p>
<p class="p1"><span class="Apple-converted-space">                        </span>resource: {</p>
<p class="p1"><span class="Apple-converted-space">                            </span>values: [['Serial Number', 'Date', 'Knife Style', 'Steel Type', 'Handle Material', 'Blade Length', 'Overall Length', 'Price', 'Notes', 'Description', 'Photos Folder', 'Photo Links', 'Timestamp']]</p>
<p class="p1"><span class="Apple-converted-space">                        </span>}</p>
<p class="p1"><span class="Apple-converted-space">                    </span>});</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>// Format header row</p>
<p class="p1"><span class="Apple-converted-space">                    </span>await gapi.client.sheets.spreadsheets.batchUpdate({</p>
<p class="p1"><span class="Apple-converted-space">                        </span>spreadsheetId: spreadsheetId,</p>
<p class="p1"><span class="Apple-converted-space">                        </span>resource: {</p>
<p class="p1"><span class="Apple-converted-space">                            </span>requests: [</p>
<p class="p1"><span class="Apple-converted-space">                                </span>{</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>repeatCell: {</p>
<p class="p1"><span class="Apple-converted-space">                                        </span>range: {</p>
<p class="p1"><span class="Apple-converted-space">                                            </span>sheetId: 0,</p>
<p class="p1"><span class="Apple-converted-space">                                            </span>startRowIndex: 0,</p>
<p class="p1"><span class="Apple-converted-space">                                            </span>endRowIndex: 1</p>
<p class="p1"><span class="Apple-converted-space">                                        </span>},</p>
<p class="p1"><span class="Apple-converted-space">                                        </span>cell: {</p>
<p class="p1"><span class="Apple-converted-space">                                            </span>userEnteredFormat: {</p>
<p class="p1"><span class="Apple-converted-space">                                                </span>textFormat: {</p>
<p class="p1"><span class="Apple-converted-space">                                                    </span>bold: true</p>
<p class="p1"><span class="Apple-converted-space">                                                </span>},</p>
<p class="p1"><span class="Apple-converted-space">                                                </span>backgroundColor: {</p>
<p class="p1"><span class="Apple-converted-space">                                                    </span>red: 0.8,</p>
<p class="p1"><span class="Apple-converted-space">                                                    </span>green: 0.8,</p>
<p class="p1"><span class="Apple-converted-space">                                                    </span>blue: 0.8</p>
<p class="p1"><span class="Apple-converted-space">                                                </span>}</p>
<p class="p1"><span class="Apple-converted-space">                                            </span>}</p>
<p class="p1"><span class="Apple-converted-space">                                        </span>},</p>
<p class="p1"><span class="Apple-converted-space">                                        </span>fields: 'userEnteredFormat(textFormat,backgroundColor)'</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>}</p>
<p class="p1"><span class="Apple-converted-space">                                </span>}</p>
<p class="p1"><span class="Apple-converted-space">                            </span>]</p>
<p class="p1"><span class="Apple-converted-space">                        </span>}</p>
<p class="p1"><span class="Apple-converted-space">                    </span>});</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// Check if "Knife Photos" folder exists in Google Drive</p>
<p class="p1"><span class="Apple-converted-space">                </span>const driveResponse = await gapi.client.drive.files.list({</p>
<p class="p1"><span class="Apple-converted-space">                    </span>q: "name='Knife Photos' and mimeType='application/vnd.google-apps.folder'",</p>
<p class="p1"><span class="Apple-converted-space">                    </span>fields: 'files(id, name)'</p>
<p class="p1"><span class="Apple-converted-space">                </span>});</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>if (driveResponse.result.files &amp;&amp; driveResponse.result.files.length &gt; 0) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>folderId = driveResponse.result.files[0].id;</p>
<p class="p1"><span class="Apple-converted-space">                </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>// Create a new folder</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const folderResponse = await gapi.client.drive.files.create({</p>
<p class="p1"><span class="Apple-converted-space">                        </span>resource: {</p>
<p class="p1"><span class="Apple-converted-space">                            </span>name: 'Knife Photos',</p>
<p class="p1"><span class="Apple-converted-space">                            </span>mimeType: 'application/vnd.google-apps.folder'</p>
<p class="p1"><span class="Apple-converted-space">                        </span>},</p>
<p class="p1"><span class="Apple-converted-space">                        </span>fields: 'id'</p>
<p class="p1"><span class="Apple-converted-space">                    </span>});</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>folderId = folderResponse.result.id;</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>document.getElementById('saveStatus').textContent = 'Google resources set up successfully!';</p>
<p class="p1"><span class="Apple-converted-space">                </span>setTimeout(() =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>document.getElementById('saveStatus').textContent = '';</p>
<p class="p1"><span class="Apple-converted-space">                </span>}, 3000);</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>} catch (error) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>console.error('Error setting up Google resources:', error);</p>
<p class="p1"><span class="Apple-converted-space">                </span>document.getElementById('saveStatus').textContent = 'Error setting up Google resources: ' + error.message;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Load previous entries from the spreadsheet</p>
<p class="p1"><span class="Apple-converted-space">        </span>async function loadPreviousEntries() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>try {</p>
<p class="p1"><span class="Apple-converted-space">                </span>const response = await gapi.client.sheets.spreadsheets.values.get({</p>
<p class="p1"><span class="Apple-converted-space">                    </span>spreadsheetId: spreadsheetId,</p>
<p class="p1"><span class="Apple-converted-space">                    </span>range: 'Knives!A2:G'</p>
<p class="p1"><span class="Apple-converted-space">                </span>});</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>const rows = response.result.values || [];</p>
<p class="p1"><span class="Apple-converted-space">                </span>const tableBody = document.getElementById('entriesTableBody');</p>
<p class="p1"><span class="Apple-converted-space">                </span>tableBody.innerHTML = '';</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>rows.forEach((row, index) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (row.length &gt;= 7) {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>const tr = document.createElement('tr');</p>
<p class="p1"><span class="Apple-converted-space">                        </span>tr.innerHTML = `</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;td class="py-2 px-4 border-b"&gt;${row[0]}&lt;/td&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;td class="py-2 px-4 border-b"&gt;${row[1]}&lt;/td&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;td class="py-2 px-4 border-b"&gt;${row[2]}&lt;/td&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;td class="py-2 px-4 border-b"&gt;${row[3]}&lt;/td&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;td class="py-2 px-4 border-b"&gt;${row[4]}&lt;/td&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;td class="py-2 px-4 border-b"&gt;£${row[7]}&lt;/td&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;td class="py-2 px-4 border-b"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;button class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-1 px-2 rounded mr-1 view-btn" data-row="${index+2}"&gt;View&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/td&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>`;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>tableBody.appendChild(tr);</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}</p>
<p class="p1"><span class="Apple-converted-space">                </span>});</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// Add event listeners to view buttons</p>
<p class="p1"><span class="Apple-converted-space">                </span>document.querySelectorAll('.view-btn').forEach(button =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>button.addEventListener('click', function() {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>const rowIndex = this.getAttribute('data-row');</p>
<p class="p1"><span class="Apple-converted-space">                        </span>viewKnifeDetails(rowIndex);</p>
<p class="p1"><span class="Apple-converted-space">                    </span>});</p>
<p class="p1"><span class="Apple-converted-space">                </span>});</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>} catch (error) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>console.error('Error loading previous entries:', error);</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// View knife details</p>
<p class="p1"><span class="Apple-converted-space">        </span>async function viewKnifeDetails(rowIndex) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>try {</p>
<p class="p1"><span class="Apple-converted-space">                </span>const response = await gapi.client.sheets.spreadsheets.values.get({</p>
<p class="p1"><span class="Apple-converted-space">                    </span>spreadsheetId: spreadsheetId,</p>
<p class="p1"><span class="Apple-converted-space">                    </span>range: `Knives!A${rowIndex}:L${rowIndex}`</p>
<p class="p1"><span class="Apple-converted-space">                </span>});</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>const row = response.result.values[0];</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// Populate the form with the knife details</p>
<p class="p1"><span class="Apple-converted-space">                </span>document.getElementById('serialNumber').value = row[0];</p>
<p class="p1"><span class="Apple-converted-space">                </span>document.getElementById('dateCreated').value = row[1];</p>
<p class="p1"><span class="Apple-converted-space">                </span>document.getElementById('knifeStyle').value = row[2];</p>
<p class="p1"><span class="Apple-converted-space">                </span>document.getElementById('steelType').value = row[3];</p>
<p class="p1"><span class="Apple-converted-space">                </span>document.getElementById('handleMaterial').value = row[4];</p>
<p class="p1"><span class="Apple-converted-space">                </span>document.getElementById('bladeLength').value = row[5];</p>
<p class="p1"><span class="Apple-converted-space">                </span>document.getElementById('overallLength').value = row[6];</p>
<p class="p1"><span class="Apple-converted-space">                </span>document.getElementById('price').value = row[7];</p>
<p class="p1"><span class="Apple-converted-space">                </span>document.getElementById('notes').value = row[8];</p>
<p class="p1"><span class="Apple-converted-space">                </span>document.getElementById('description').value = row[9];</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// Clear photo previews</p>
<p class="p1"><span class="Apple-converted-space">                </span>document.getElementById('photoPreviewContainer').innerHTML = '';</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// If there are photo links, try to show them</p>
<p class="p1"><span class="Apple-converted-space">                </span>if (row[11]) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const photoLinks = row[11].split(',');</p>
<p class="p1"><span class="Apple-converted-space">                    </span>photoLinks.forEach(photoLink =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>if (photoLink.trim()) {</p>
<p class="p1"><span class="Apple-converted-space">                            </span>const img = document.createElement('img');</p>
<p class="p1"><span class="Apple-converted-space">                            </span>img.src = photoLink.trim();</p>
<p class="p1"><span class="Apple-converted-space">                            </span>img.className = 'photo-preview';</p>
<p class="p1"><span class="Apple-converted-space">                            </span>document.getElementById('photoPreviewContainer').appendChild(img);</p>
<p class="p1"><span class="Apple-converted-space">                        </span>}</p>
<p class="p1"><span class="Apple-converted-space">                    </span>});</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>document.getElementById('saveStatus').textContent = 'Knife details loaded. You can make changes and save again.';</p>
<p class="p1"><span class="Apple-converted-space">                </span>setTimeout(() =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>document.getElementById('saveStatus').textContent = '';</p>
<p class="p1"><span class="Apple-converted-space">                </span>}, 3000);</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>} catch (error) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>console.error('Error viewing knife details:', error);</p>
<p class="p1"><span class="Apple-converted-space">                </span>document.getElementById('saveStatus').textContent = 'Error viewing knife details: ' + error.message;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Photo preview functionality</p>
<p class="p1"><span class="Apple-converted-space">        </span>document.getElementById('photos').addEventListener('change', function(event) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const files = event.target.files;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const container = document.getElementById('photoPreviewContainer');</p>
<p class="p1"><span class="Apple-converted-space">            </span>container.innerHTML = '';</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>if (files.length &gt; 10) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>alert('You can only upload up to 10 photos.');</p>
<p class="p1"><span class="Apple-converted-space">                </span>this.value = '';</p>
<p class="p1"><span class="Apple-converted-space">                </span>return;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>for (let i = 0; i &lt; files.length; i++) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>const file = files[i];</p>
<p class="p1"><span class="Apple-converted-space">                </span>if (file.type.startsWith('image/')) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const reader = new FileReader();</p>
<p class="p1"><span class="Apple-converted-space">                    </span>reader.onload = function(e) {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>const img = document.createElement('img');</p>
<p class="p1"><span class="Apple-converted-space">                        </span>img.src = e.target.result;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>img.className = 'photo-preview';</p>
<p class="p1"><span class="Apple-converted-space">                        </span>container.appendChild(img);</p>
<p class="p1"><span class="Apple-converted-space">                    </span>};</p>
<p class="p1"><span class="Apple-converted-space">                    </span>reader.readAsDataURL(file);</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>});</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Add new knife style</p>
<p class="p1"><span class="Apple-converted-space">        </span>document.getElementById('addKnifeStyle').addEventListener('click', function() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const newStyle = document.getElementById('newKnifeStyle').value.trim();</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (newStyle) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>const select = document.getElementById('knifeStyle');</p>
<p class="p1"><span class="Apple-converted-space">                </span>const option = document.createElement('option');</p>
<p class="p1"><span class="Apple-converted-space">                </span>option.value = newStyle;</p>
<p class="p1"><span class="Apple-converted-space">                </span>option.textContent = newStyle;</p>
<p class="p1"><span class="Apple-converted-space">                </span>select.appendChild(option);</p>
<p class="p1"><span class="Apple-converted-space">                </span>select.value = newStyle;</p>
<p class="p1"><span class="Apple-converted-space">                </span>document.getElementById('newKnifeStyle').value = '';</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>});</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Add new steel type</p>
<p class="p1"><span class="Apple-converted-space">        </span>document.getElementById('addSteelType').addEventListener('click', function() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const newSteel = document.getElementById('newSteelType').value.trim();</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (newSteel) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>const select = document.getElementById('steelType');</p>
<p class="p1"><span class="Apple-converted-space">                </span>const option = document.createElement('option');</p>
<p class="p1"><span class="Apple-converted-space">                </span>option.value = newSteel;</p>
<p class="p1"><span class="Apple-converted-space">                </span>option.textContent = newSteel;</p>
<p class="p1"><span class="Apple-converted-space">                </span>select.appendChild(option);</p>
<p class="p1"><span class="Apple-converted-space">                </span>select.value = newSteel;</p>
<p class="p1"><span class="Apple-converted-space">                </span>document.getElementById('newSteelType').value = '';</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>});</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Add new handle material</p>
<p class="p1"><span class="Apple-converted-space">        </span>document.getElementById('addHandleMaterial').addEventListener('click', function() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const newMaterial = document.getElementById('newHandleMaterial').value.trim();</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (newMaterial) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>const select = document.getElementById('handleMaterial');</p>
<p class="p1"><span class="Apple-converted-space">                </span>const option = document.createElement('option');</p>
<p class="p1"><span class="Apple-converted-space">                </span>option.value = newMaterial;</p>
<p class="p1"><span class="Apple-converted-space">                </span>option.textContent = newMaterial;</p>
<p class="p1"><span class="Apple-converted-space">                </span>select.appendChild(option);</p>
<p class="p1"><span class="Apple-converted-space">                </span>select.value = newMaterial;</p>
<p class="p1"><span class="Apple-converted-space">                </span>document.getElementById('newHandleMaterial').value = '';</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>});</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Generate AI description</p>
<p class="p1"><span class="Apple-converted-space">        </span>document.getElementById('generateDescription').addEventListener('click', function() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>generateKnifeDescription();</p>
<p class="p1"><span class="Apple-converted-space">        </span>});</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Function to generate knife description based on input fields</p>
<p class="p1"><span class="Apple-converted-space">        </span>function generateKnifeDescription() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const bladeLength = document.getElementById('bladeLength').value;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const knifeStyle = document.getElementById('knifeStyle').value;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const steelType = document.getElementById('steelType').value;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const handleMaterial = document.getElementById('handleMaterial').value;</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>if (!bladeLength || !knifeStyle || !steelType || !handleMaterial) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>alert('Please fill in blade length, knife style, steel type, and handle material before generating a description.');</p>
<p class="p1"><span class="Apple-converted-space">                </span>return;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>let steelDescription = '';</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (steelType.includes('AEB-L')) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>steelDescription = 'known in the industry for its fine grain structure and ability to obtain a razor like edge';</p>
<p class="p1"><span class="Apple-converted-space">            </span>} else if (steelType.includes('80CrV2')) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>steelDescription = 'renowned for its toughness, hardness, and razor edge';</p>
<p class="p1"><span class="Apple-converted-space">            </span>} else if (steelType.includes('White Paper San Mai')) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>steelDescription = 'an exceptionally pure and fine grained steel';</p>
<p class="p1"><span class="Apple-converted-space">            </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                </span>steelDescription = 'a high-quality steel known for its excellent edge retention and durability';</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>let knifeDescription = '';</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (knifeStyle === 'Chef' || knifeStyle === 'Gyuto') {</p>
<p class="p1"><span class="Apple-converted-space">                </span>knifeDescription = 'This knife is a true all rounder in the kitchen. ' +<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>(knifeStyle === 'Gyuto' ?<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                        </span>'This Japanese influenced profile features a long cutting edge, with a deep heel and distal taper towards the tip.' :<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                        </span>'The European profile features a deep heel and great knuckle clearance, for robust chopping, and a fine tip for slicing and more delicate work.');</p>
<p class="p1"><span class="Apple-converted-space">            </span>} else if (knifeStyle === 'Santoku') {</p>
<p class="p1"><span class="Apple-converted-space">                </span>knifeDescription = 'The deep blade and short profile of this blade is designed to chop. The slight curve of the edge and flat heal mean you\'ll be able to rock chop (till you drop...) without leaving those little bits of vegetables uncut at the very end of the slice.';</p>
<p class="p1"><span class="Apple-converted-space">            </span>} else if (knifeStyle === 'Paring') {</p>
<p class="p1"><span class="Apple-converted-space">                </span>knifeDescription = 'The paring knife is perfect for any small or delicate kitchen tasks such as cutting herbs and garlic, peeling, mincing, and generally any task that requires a light and nimble knife.';</p>
<p class="p1"><span class="Apple-converted-space">            </span>} else if (knifeStyle === 'Petty') {</p>
<p class="p1"><span class="Apple-converted-space">                </span>knifeDescription = 'A personal favorite, the petty combines the nimbleness of the paring with the full bodied blade of a chefs knife and is extremely versatile. It will perform extremely well as either a smaller knife, or a larger knife.';</p>
<p class="p1"><span class="Apple-converted-space">            </span>} else if (knifeStyle === 'Bread') {</p>
<p class="p1"><span class="Apple-converted-space">                </span>knifeDescription = 'Perfect for cutting any bread, be it a crusty sourdough or soft brioche, this serrated bread knife has the length and knuckle clearance for comfortable bread cutting.';</p>
<p class="p1"><span class="Apple-converted-space">            </span>} else if (knifeStyle === 'Cleaver') {</p>
<p class="p1"><span class="Apple-converted-space">                </span>knifeDescription = 'This rectangular profile features a deep, flat edge, and great knuckle clearance for maximum chopping efficiency.';</p>
<p class="p1"><span class="Apple-converted-space">            </span>} else if (knifeStyle === 'Oyster') {</p>
<p class="p1"><span class="Apple-converted-space">                </span>knifeDescription = 'The tip is fine enough to get into the hinge of an oyster, while also being robust enough to withstand the strong forces of opening an oyster.';</p>
<p class="p1"><span class="Apple-converted-space">            </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                </span>knifeDescription = 'This knife has an excellent balance of form and function, designed for precision cutting tasks with comfort and control.';</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>let handleDescription = '';</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (handleMaterial.includes('Tang')) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>handleDescription = `The ${handleMaterial.includes('hidden') ? 'hidden' : 'full'} tang handle`;</p>
<p class="p1"><span class="Apple-converted-space">            </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                </span>handleDescription = `The handle is ${handleMaterial}`;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>let balanceDescription = '';</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (knifeStyle === 'Chef' || knifeStyle === 'Gyuto' || knifeStyle === 'Santoku') {</p>
<p class="p1"><span class="Apple-converted-space">                </span>balanceDescription = 'The knife is balanced right where the blade meets the handle, making for a light and even feel to the knife.';</p>
<p class="p1"><span class="Apple-converted-space">            </span>} else if (handleMaterial.includes('full tang')) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>balanceDescription = 'The full tang handle adds heft for people who prefer to feel a heavier knife in hand, while still extremely well balanced and extremely comfortable to use.';</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>const description = `This ${bladeLength}" ${steelType.includes('High') ? 'High Carbon' : 'Stainless'} ${knifeStyle} knife is made from ${steelType} ${steelDescription}. ${handleDescription}, with black and white G10 liners and stainless Corby Bolts. ${knifeDescription} ${balanceDescription}`;</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('description').value = description;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Save knife to logbook</p>
<p class="p1"><span class="Apple-converted-space">        </span>document.getElementById('saveKnife').addEventListener('click', async function() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>saveKnifeToLogbook();</p>
<p class="p1"><span class="Apple-converted-space">        </span>});</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Function to save knife data to Google Sheets and Drive</p>
<p class="p1"><span class="Apple-converted-space">        </span>async function saveKnifeToLogbook() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const serialNumber = document.getElementById('serialNumber').value.trim();</p>
<p class="p1"><span class="Apple-converted-space">            </span>const dateCreated = document.getElementById('dateCreated').value;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const knifeStyle = document.getElementById('knifeStyle').value;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const steelType = document.getElementById('steelType').value;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const handleMaterial = document.getElementById('handleMaterial').value;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const bladeLength = document.getElementById('bladeLength').value;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const overallLength = document.getElementById('overallLength').value;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const price = document.getElementById('price').value;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const notes = document.getElementById('notes').value;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const description = document.getElementById('description').value;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const photos = document.getElementById('photos').files;</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Basic validation</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (!serialNumber || !dateCreated || !knifeStyle || !steelType || !handleMaterial || !bladeLength || !price) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>alert('Please fill in all required fields (Serial Number, Date, Knife Style, Steel Type, Handle Material, Blade Length, and Price).');</p>
<p class="p1"><span class="Apple-converted-space">                </span>return;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('saveStatus').textContent = 'Saving knife data...';</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>try {</p>
<p class="p1"><span class="Apple-converted-space">                </span>// Create a subfolder for this knife</p>
<p class="p1"><span class="Apple-converted-space">                </span>const knifeFolderName = `${serialNumber}_${knifeStyle}_${handleMaterial}`.replace(/[^\w\s]/gi, '_');</p>
<p class="p1"><span class="Apple-converted-space">                </span>const knifeFolder = await gapi.client.drive.files.create({</p>
<p class="p1"><span class="Apple-converted-space">                    </span>resource: {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>name: knifeFolderName,</p>
<p class="p1"><span class="Apple-converted-space">                        </span>mimeType: 'application/vnd.google-apps.folder',</p>
<p class="p1"><span class="Apple-converted-space">                        </span>parents: [folderId]</p>
<p class="p1"><span class="Apple-converted-space">                    </span>},</p>
<p class="p1"><span class="Apple-converted-space">                    </span>fields: 'id, webViewLink'</p>
<p class="p1"><span class="Apple-converted-space">                </span>});</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>const knifeFolderId = knifeFolder.result.id;</p>
<p class="p1"><span class="Apple-converted-space">                </span>const knifeFolderLink = knifeFolder.result.webViewLink;</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// Upload photos</p>
<p class="p1"><span class="Apple-converted-space">                </span>const photoLinks = [];</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>if (photos.length &gt; 0) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>for (let i = 0; i &lt; photos.length; i++) {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>const photo = photos[i];</p>
<p class="p2"><span class="Apple-converted-space">                        </span></p>
<p class="p1"><span class="Apple-converted-space">                        </span>// Create a form data object to upload the file</p>
<p class="p1"><span class="Apple-converted-space">                        </span>const form = new FormData();</p>
<p class="p1"><span class="Apple-converted-space">                        </span>form.append('metadata', new Blob([JSON.stringify({</p>
<p class="p1"><span class="Apple-converted-space">                            </span>name: `${serialNumber}_${i+1}_${photo.name}`,</p>
<p class="p1"><span class="Apple-converted-space">                            </span>parents: [knifeFolderId]</p>
<p class="p1"><span class="Apple-converted-space">                        </span>})], { type: 'application/json' }));</p>
<p class="p1"><span class="Apple-converted-space">                        </span>form.append('file', photo);</p>
<p class="p2"><span class="Apple-converted-space">                        </span></p>
<p class="p1"><span class="Apple-converted-space">                        </span>// Upload the file to Google Drive</p>
<p class="p1"><span class="Apple-converted-space">                        </span>const accessToken = gapi.auth.getToken().access_token;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>const uploadResponse = await fetch('https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart', {</p>
<p class="p1"><span class="Apple-converted-space">                            </span>method: 'POST',</p>
<p class="p1"><span class="Apple-converted-space">                            </span>headers: {</p>
<p class="p1"><span class="Apple-converted-space">                                </span>Authorization: `Bearer ${accessToken}`</p>
<p class="p1"><span class="Apple-converted-space">                            </span>},</p>
<p class="p1"><span class="Apple-converted-space">                            </span>body: form</p>
<p class="p1"><span class="Apple-converted-space">                        </span>});</p>
<p class="p2"><span class="Apple-converted-space">                        </span></p>
<p class="p1"><span class="Apple-converted-space">                        </span>const uploadResult = await uploadResponse.json();</p>
<p class="p2"><span class="Apple-converted-space">                        </span></p>
<p class="p1"><span class="Apple-converted-space">                        </span>// Make the file publicly viewable</p>
<p class="p1"><span class="Apple-converted-space">                        </span>await gapi.client.drive.permissions.create({</p>
<p class="p1"><span class="Apple-converted-space">                            </span>fileId: uploadResult.id,</p>
<p class="p1"><span class="Apple-converted-space">                            </span>resource: {</p>
<p class="p1"><span class="Apple-converted-space">                                </span>role: 'reader',</p>
<p class="p1"><span class="Apple-converted-space">                                </span>type: 'anyone'</p>
<p class="p1"><span class="Apple-converted-space">                            </span>}</p>
<p class="p1"><span class="Apple-converted-space">                        </span>});</p>
<p class="p2"><span class="Apple-converted-space">                        </span></p>
<p class="p1"><span class="Apple-converted-space">                        </span>// Get the webContentLink</p>
<p class="p1"><span class="Apple-converted-space">                        </span>const fileResponse = await gapi.client.drive.files.get({</p>
<p class="p1"><span class="Apple-converted-space">                            </span>fileId: uploadResult.id,</p>
<p class="p1"><span class="Apple-converted-space">                            </span>fields: 'webContentLink'</p>
<p class="p1"><span class="Apple-converted-space">                        </span>});</p>
<p class="p2"><span class="Apple-converted-space">                        </span></p>
<p class="p1"><span class="Apple-converted-space">                        </span>photoLinks.push(fileResponse.result.webContentLink);</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// Prepare data for the spreadsheet</p>
<p class="p1"><span class="Apple-converted-space">                </span>const timestamp = new Date().toISOString();</p>
<p class="p1"><span class="Apple-converted-space">                </span>const rowData = [</p>
<p class="p1"><span class="Apple-converted-space">                    </span>serialNumber,</p>
<p class="p1"><span class="Apple-converted-space">                    </span>dateCreated,</p>
<p class="p1"><span class="Apple-converted-space">                    </span>knifeStyle,</p>
<p class="p1"><span class="Apple-converted-space">                    </span>steelType,</p>
<p class="p1"><span class="Apple-converted-space">                    </span>handleMaterial,</p>
<p class="p1"><span class="Apple-converted-space">                    </span>bladeLength,</p>
<p class="p1"><span class="Apple-converted-space">                    </span>overallLength,</p>
<p class="p1"><span class="Apple-converted-space">                    </span>price,</p>
<p class="p1"><span class="Apple-converted-space">                    </span>notes,</p>
<p class="p1"><span class="Apple-converted-space">                    </span>description,</p>
<p class="p1"><span class="Apple-converted-space">                    </span>knifeFolderLink,</p>
<p class="p1"><span class="Apple-converted-space">                    </span>photoLinks.join(','),</p>
<p class="p1"><span class="Apple-converted-space">                    </span>timestamp</p>
<p class="p1"><span class="Apple-converted-space">                </span>];</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// Find if this serial number already exists</p>
<p class="p1"><span class="Apple-converted-space">                </span>const existingResponse = await gapi.client.sheets.spreadsheets.values.get({</p>
<p class="p1"><span class="Apple-converted-space">                    </span>spreadsheetId: spreadsheetId,</p>
<p class="p1"><span class="Apple-converted-space">                    </span>range: 'Knives!A:A'</p>
<p class="p1"><span class="Apple-converted-space">                </span>});</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>const serialNumbers = existingResponse.result.values || [];</p>
<p class="p1"><span class="Apple-converted-space">                </span>let existingRow = -1;</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>for (let i = 1; i &lt; serialNumbers.length; i++) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (serialNumbers[i] &amp;&amp; serialNumbers[i][0] === serialNumber) {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>existingRow = i + 1; // +1 because rows are 1-indexed in sheets API</p>
<p class="p1"><span class="Apple-converted-space">                        </span>break;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// Update or append data</p>
<p class="p1"><span class="Apple-converted-space">                </span>if (existingRow &gt; 1) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>// Update existing row</p>
<p class="p1"><span class="Apple-converted-space">                    </span>await gapi.client.sheets.spreadsheets.values.update({</p>
<p class="p1"><span class="Apple-converted-space">                        </span>spreadsheetId: spreadsheetId,</p>
<p class="p1"><span class="Apple-converted-space">                        </span>range: `Knives!A${existingRow}:M${existingRow}`,</p>
<p class="p1"><span class="Apple-converted-space">                        </span>valueInputOption: 'RAW',</p>
<p class="p1"><span class="Apple-converted-space">                        </span>resource: {</p>
<p class="p1"><span class="Apple-converted-space">                            </span>values: [rowData]</p>
<p class="p1"><span class="Apple-converted-space">                        </span>}</p>
<p class="p1"><span class="Apple-converted-space">                    </span>});</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>document.getElementById('saveStatus').textContent = `Knife data updated for serial number ${serialNumber}`;</p>
<p class="p1"><span class="Apple-converted-space">                </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>// Append new row</p>
<p class="p1"><span class="Apple-converted-space">                    </span>await gapi.client.sheets.spreadsheets.values.append({</p>
<p class="p1"><span class="Apple-converted-space">                        </span>spreadsheetId: spreadsheetId,</p>
<p class="p1"><span class="Apple-converted-space">                        </span>range: 'Knives!A:M',</p>
<p class="p1"><span class="Apple-converted-space">                        </span>valueInputOption: 'RAW',</p>
<p class="p1"><span class="Apple-converted-space">                        </span>insertDataOption: 'INSERT_ROWS',</p>
<p class="p1"><span class="Apple-converted-space">                        </span>resource: {</p>
<p class="p1"><span class="Apple-converted-space">                            </span>values: [rowData]</p>
<p class="p1"><span class="Apple-converted-space">                        </span>}</p>
<p class="p1"><span class="Apple-converted-space">                    </span>});</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>document.getElementById('saveStatus').textContent = `New knife data saved with serial number ${serialNumber}`;</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>// If this was a new entry, increment the serial number for the next knife</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const nextSerial = (parseInt(serialNumber.replace(/\D/g, '')) + 1).toString().padStart(3, '0');</p>
<p class="p1"><span class="Apple-converted-space">                    </span>document.getElementById('serialNumber').value = nextSerial;</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// Reload previous entries</p>
<p class="p1"><span class="Apple-converted-space">                </span>loadPreviousEntries();</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// Reset form except serial number and date</p>
<p class="p1"><span class="Apple-converted-space">                </span>document.getElementById('knifeStyle').value = '';</p>
<p class="p1"><span class="Apple-converted-space">                </span>document.getElementById('steelType').value = '';</p>
<p class="p1"><span class="Apple-converted-space">                </span>document.getElementById('handleMaterial').value = '';</p>
<p class="p1"><span class="Apple-converted-space">                </span>document.getElementById('bladeLength').value = '';</p>
<p class="p1"><span class="Apple-converted-space">                </span>document.getElementById('overallLength').value = '';</p>
<p class="p1"><span class="Apple-converted-space">                </span>document.getElementById('price').value = '';</p>
<p class="p1"><span class="Apple-converted-space">                </span>document.getElementById('notes').value = '';</p>
<p class="p1"><span class="Apple-converted-space">                </span>document.getElementById('description').value = '';</p>
<p class="p1"><span class="Apple-converted-space">                </span>document.getElementById('photos').value = '';</p>
<p class="p1"><span class="Apple-converted-space">                </span>document.getElementById('photoPreviewContainer').innerHTML = '';</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>setTimeout(() =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>document.getElementById('saveStatus').textContent = '';</p>
<p class="p1"><span class="Apple-converted-space">                </span>}, 5000);</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>} catch (error) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>console.error('Error saving knife data:', error);</p>
<p class="p1"><span class="Apple-converted-space">                </span>document.getElementById('saveStatus').textContent = 'Error saving knife data: ' + error.message;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/script&gt;</p>
<p class="p1">&lt;/body&gt;</p>
<p class="p1">&lt;/html&gt;</p>
</body>
</html>
